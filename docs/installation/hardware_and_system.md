# 硬件与系统

本部分提供了针对不同使用需求下的计算机硬件配置要求详表，计算机操作系统要求及最佳化配置解决方案。

## 硬件配置要求

CARLA由于处理管线优化问题的存在，对计算机硬件性能有苛刻的要求。根据使用CARLA的场景不同，可以分为：开发用途、实时用途与非实时用途。

其中，开发用途因为涉及CARLA及UnrealEngine的源码编译，对计算机硬件性能有着最高的要求；实时用途需要满足传感器的最低采样率或决策的最低粒度，根据需求的不同，对计算机性能的要求也不同；非实时用途（如数据集采集）在满足CARLA支持的最低硬件配置要求下即可达成硬件需求。

> [!NOTE]
> 本章节会随着“CARLA边界探索（运算资源部分）”项目的推进即时更新内容

### 最低硬件配置要求

对于CARLA而言，能够正常启动CARLA Server即代表可以使用，最低硬盘配置要求如下。

|   类别    |   名称  |
|  ----     | ----  |
|   CPU     | Intel或AMD 4核 |
|   RAM     | DDR4 8GB |
|   GPU     | GTX970 |

> [!ATTENTION]
> CPU需要保证最低四个物理核心， 非逻辑核心
> 
> GPU最低配置要求需要至少使用标准电压版显卡， 即非笔记本用显卡

> [!WARNING]
> 最低配置来自于CARLA官方文档，未经过实际的测试

### 实时用途使用推荐配置

对于一般的实时用途（1CAM + 1LiDAR）传感器配置下的车辆可以参考下列配置，如果配置的车辆拥有更多的传感器，请参考开发用途推荐配置。

|   类别    |   名称  |
|  ----     | ----  |
|   CPU     | i7-8700 |
|   RAM     | DDR4 8GB |
|   GPU     | GTX1070 |

> [!WARNING]
> 该配置未经过严格的实际测试

### 开发用途推荐配置

开发用途可以以该配置为基准，如果对性能有更高的要求，推荐进一步升级显卡。

|   类别    |   名称  |
|  ----     | ----  |
|   CPU     | i7-10700KF |
|   RAM     | DDR4 16GB |
|   GPU     | RTX3070 |

> [!TIP]
> 使用RTX2080及以上级别的GPU可以满足开发用途的基本需要

## 操作系统要求

CARLA官方支持Windows以及Ubuntu的64位操作系统。但是，由于绝大部分工作需要使用ROS与CARLA ROS Bridge，以及为了避免操作系统版本问题引发未知错误的考虑，本教程统一要求使用`Ubuntu 18.04 LTS`操作系统。

> [!TIP]
> 请在了解Ubuntu基础操作以及Terminal命令的基础上使用本文档

## 显卡驱动

无论使用何种配置，请务必确保显卡驱动已经正确安装且正在运行。

> [!ATTENTION]
> 显卡无法识别或显卡驱动未正常配置会导致CARLA运行失败。

### 检查显卡驱动
对于NVIDIA显卡，可以通过命令`nvidia-smi`检查。出现类似如下内容说明显卡驱动已经正常安装.
```
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 455.38       Driver Version: 455.38       CUDA Version: 11.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  GeForce RTX 3070    Off  | 00000000:01:00.0  On |                  N/A |
|  0%   39C    P8    12W / 270W |    246MiB /  7979MiB |      3%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|    0   N/A  N/A      1218      G   /usr/lib/xorg/Xorg                 18MiB |
|    0   N/A  N/A      1329      G   /usr/bin/gnome-shell               52MiB |
|    0   N/A  N/A      1606      G   /usr/lib/xorg/Xorg                 86MiB |
|    0   N/A  N/A      1750      G   /usr/bin/gnome-shell               84MiB |
+-----------------------------------------------------------------------------+

```

### 安装显卡驱动

使用Ubuntu系统的驱动自动安装显卡驱动是安装显卡驱动最为便利的方法。

```
sudo ubuntu-drivers autoinstall
```
安装完成后，请重启计算机后，再次检查显卡驱动。